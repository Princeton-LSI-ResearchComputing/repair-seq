#!/usr/bin/env python3

import argparse
from pathlib import Path

import tqdm

from repair_seq import pooled_screen

parser = argparse.ArgumentParser()

parser.add_argument('pool')
parser.add_argument('max_procs', type=int)
parser.add_argument('--progress', const=tqdm.tqdm, action='store_const')
parser.add_argument('--base_dir', type=Path, default=Path.home() / 'projects' / 'repair_seq')

args = parser.parse_args()

pool = pooled_screen.get_pool(args.base_dir, args.pool, progress=args.progress)
pool.process(num_processes=args.max_procs)